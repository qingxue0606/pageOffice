<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xmlns:th="http://www.thymeleaf.org"
      xmlns:sec="http://www.thymeleaf.org/thymeleaf-extras-springsecurity3">
<head>
    <title></title>
</head>
<body>
<script type="text/javascript">

    function Save() {
        document.getElementById("PageOfficeCtrl1").WebSave();
    }

    function AfterDocumentOpened() {
        refreshList();
    }


    function getComment(index){
        var sMac = "Function getCmtTxt() " + "\r\n"
            + "getCmtTxt = ActiveDocument.Comments.Item(" + index + ").Range.Text " + "\r\n"
            + "End Function ";

        return document.getElementById("PageOfficeCtrl1").RunMacro("getCmtTxt", sMac);
    }

    function goToComment(index)
    {
        var docObj = poapplication.ActiveDocument;;
        docObj .Comments.Item(index).Edit();
    }

    function addComment(txt) {

        poapplication.ActiveDocument.Selection.Comments.Add(poapplication.ActiveDocument.Selection.Range,txt);


    }
    function Button1_onclick() {
        addComment(document.getElementById("Text1").value);
        refreshList();
        document.getElementById("Text1").value = "";
    }

    function Button2_onclick() {
        refreshList();
    }

    function refreshList() {
        var docObj = poapplication.ActiveDocument;
        var arr=new Array();
        var Comments="";

        for(var i=1; i < docObj.Comments.Count+1; i++){
            Comments=docObj.Comments.Item(i).Author +":" + docObj.Comments.Item(i).Range.Text;
            arr.push(Comments)
        }
        document.getElementById("ul_Comments").innerHTML = "";
        for (var i = 0; i < arr.length ; i++) {
            document.getElementById("ul_Comments").innerHTML += "<li><a href='#' onclick='goToComment(" + (i + 1) + ")'>" + arr[i] + "</a></li>"
        }
    }

    function InsertComment() {
        addComment("");
    }

</script>

<form id="form1">
    <div  style=" width:1300px; height:700px;">
        <div id="Div_Comments" style=" float:left; width:200px; height:700px; border:solid 1px red;">
            <h3>批注列表</h3>
            <input id="Button2" type="button" value="刷新" onclick="return Button2_onclick()" />
            <ul id="ul_Comments">

            </ul>
        </div>
        <div  style=" width:1050px; height:700px; float:right;">
            <input id="Button1" type="button" value="插入批注" onclick="return Button1_onclick()" />
            <input id="Text1" type="text" />

            <div th:replace="/common/common::office" ></div>
        </div>
    </div>
</form>



</body>

</html>
